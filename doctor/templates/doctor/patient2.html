{% extends 'account/base.html' %}
{% block content %}


<div class="row no-margin-padding">
  <div class="col-md-6">
    <h3 class="block-title">Patient Details</h3>
  </div>
  <div class="col-md-6">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="index.html">
          <span class="ti-home"></span>
        </a>
                  </li>
                  <li class="breadcrumb-item">Patients</li>
      <li class="breadcrumb-item active">Patient Details</li>
    </ol>
  </div>
</div>
<!-- /Page Title -->

<!-- /Breadcrumb -->
<!-- Main Content -->
<div class="container-fluid">

  <div class="row">
    <!-- Widget Item -->
    <div class="col-md-6">
      <div class="widget-area-2 proclinic-box-shadow">
        <h3 class="widget-title">Patient Details</h3>
        <div class="table-responsive">
          <table class="table table-bordered">
            <tbody>
              {% if  scanCode %}
                {% for Patient in scanCode%}
              <tr>
                <td><strong>First Name</strong></td>
                <td>{{ Patient.firstname }}</td>
              </tr>
              <tr>
                <td><strong>Last Name</strong></td>
                <td>{{Patient.lastname}} </td>
              </tr>
              <tr>
                <td><strong>Date Of Birth</strong> </td>
                <td>{{ Patient.dob }}</td>
              </tr>

            </tbody>

          </table>
          <style>
          .entry:not(:first-of-type)
                        {
                            margin-top: 10px;
                        }

                        .glyphicon
                        {
                            font-size: 12px;
                        }
          </style>
          <!-- <div class="container"> -->

          <div class="control-group" id="fields">
            <label class="control-label" for="field1">Symptoms:</label>
            <div class="controls">
                <form class="form-horizontal" method="POST" action="">
                  {% csrf_token %}

                    {{ formset.management_form }}
                    {% for form in formset %}
                    <div>
                        {{form.symptoms}}
                      <span class="input-group-btn">
                            <button class="btn btn-success btn-add add-form-row" type="button">
                                <span class="fas fa-plus"></span>
                            </button>
                        </span>
                        {% endfor %}
                    </div>
                            <button type="submit" class="btn  btn-primary">Create</button>
                </form>


          </div>
        </div>
     <!-- </div>  -->




                      <button type="button" class="btn btn-success mb-3"><span class="fas fa-vial"></span><a href="{% url 'doctor:patient-pharmacy' Patient.code %}"> Send For Test</button>
                        <button type="button" class="btn btn-info mb-3"><span class="fas fa-bed"></span><a href="{% url 'doctor:patient-icu' Patient.code %}"> Assign room</a></button>
                      <button type="button" class="btn btn-danger mb-3"><span class="fas fa-book-dead"></span><a href="{% url 'doctor:death_report' Patient.code %}"> Death Report</a></button>
  </div>
      </div>  {% endfor %}
      {% endif %}
    <!-- </div> -->
    <!-- /Widget Item -->
              <!-- Widget Item -->
    <div class="col-md-6">
      <div class="widget-area-2 proclinic-box-shadow">
        <h3 class="widget-title">Patient Medical Information</h3>
        <div class="table-responsive">
          <table class="table table-bordered">
            <tbody>
              {% for Patient in scanCode %}
              <tr>
                <td><strong>Age</strong></td>
                <td>{{ Patient.age }}</td>
              </tr>
              <tr>
                <td><strong>Gender</strong></td>
                <td>{{ Patient.gender  }}</td>
              </tr>
              <tr>
                <td><strong>Weight</strong></td>
                <td>{{ Patient.weight }} KG</td>
              </tr>
              <tr>
                <td><strong>Allergies</strong> </td>
                <td>{{ Patient.allergies }}</td>
              </tr>
              <tr>
                <td><strong>Blood Group</strong></td>
                <td>{{ Patient.blood_group }}</td>
              </tr>
              <tr>
                <td><strong>Diabetes</strong></td>
                <td>{{ Patient.diabetic }}</td>
              </tr>
              <tr>
                <td><strong>High Blood Pressure</strong></td>
                <td>{{ Patient.high_blood_pressure }}</td>
              </tr>
              <!-- <tr>
                <td><strong>High Blood Pressure</strong></td>
                <td>{{ Patient.high_blood_pressure }}</td>
              </tr> -->
              <tr>

              </tr>

            </tbody>
          </table>
          {%if onGoing%}
          <button type="button" class="btn btn-info mb-3"><span class="fas fa-feather-alt"></span><a href="{% url 'doctor:reports' onGoing.patient onGoing.id %}"> Prescription</button>
            <button type="button" class="btn btn-secondary mb-3"><span class="fas fa-edit"></span><a href="{% url 'reception:add-patient-medical' Patient.id %}"> Update medical Infos</button>
            {% endif %}
            {% endfor %}
        </div>
        <!-- <button type="button" class="btn btn-info mb-4"><span class="ti-pencil-alt"></span> Edit Patient</button> -->

          <!-- /Export links-->
        </div>
      </div>
      </div>


     <div class="row">
        <!-- Widget Item -->
        <div class="col-md-12">
          <div class="widget-area-2 proclinic-box-shadow">
        				<div class="profile-tabs">
        					<ul class="nav nav-tabs nav-tabs-bottom">
                    {% if not deceased%}
                    <li class="nav-item"><a class="nav-link active" href="#appointment" data-toggle="tab">On Going</a></li>
                    {% endif %}
        						<li class="nav-item"><a class="nav-link " href="#about-cont" data-toggle="tab">Medical History</a></li>
        						<li class="nav-item"><a class="nav-link" href="#bottom-tab2" data-toggle="tab">Tests</a></li>
        						<!-- <li class="nav-item"><a class="nav-link" href="#bottom-tab3" data-toggle="tab">Tab</a></li> -->
        					</ul>
                  {% if deceased %}

                      <span class="stamp is-nope">Deceased</span>

                  {% endif %}
                  <div class="tab-content">
                    {% if not deceased %}
        						<div class="tab-pane show active" id="appointment">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card-box">
                                  <div class="table-responsive">
									                    <table class="table  table-bordered" style="width:100%">
                                        <thead>

                                          <tr>
                                              <th>Appointment</th>
                                              <th>Status</th>
                                              <th>Action</th>


                                          </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td>{{onGoing.created_date}}</td>

                                            {% if onGoing.cashappointmentstatus.status == 'Unpaid' %}
                                            <td><span class="badge badge-pill badge-danger">{{ onGoing.cashappointmentstatus.status }}</span></td>
                                            {% elif onGoing.cashappointmentstatus.status == 'Paid' %}
                                            <td><span class="badge badge-pill badge-success">{{ onGoing.cashappointmentstatus.status }}</span></td>
                                            {% endif %}
                                            {% if onGoing.cashappointmentstatus.status == 'Unpaid' %}
                                            <td><span class="badge badge-pill badge-secondary">Add Report</span></td>
                                            {% elif onGoing.cashappointmentstatus.status == 'Paid' %}
                                            <td><a href="{% url 'doctor:reports' onGoing.patient onGoing.id %}"><span class="badge badge-pill badge-info">Add a report</span></a></td>
                                            {% endif %}
                                            <!-- <td><a href="{% url 'doctor:reports' onGoing.patient onGoing.id %}"><span class="badge badge-pill badge-info">Add a report</span></a></td> -->

                                            {% if not onGoing %}
                                            <td>No appoitment</td>
                                            {% endif %}


                                        </tr>
                                   </tbody>
                                    </table>
                                  </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        {% endif%}



        						<div class="tab-pane " id="about-cont">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card-box">
                                <div class="table-responsive">
									                    <table class="table  table-bordered" style="width:100%">
                                        <thead>
                                          <tr>
                                              <th>Latest Visit</th>
                                              <th>Doctor visited</th>
                                              <th>Department</th>
                                              <th>Comments</th>


                                          </tr>
                                        </thead>
                                        {% for Appointment in history%}
                                        <tbody>
                                        <tr>
                                            <td>{{Appointment.created_date}}</td>
                                            <td>{{Appointment.doctor}}</td>
                                            <td>N/A</td>
                                        </tr>

                                        {% endfor %}

                                      </tbody>



                                    </table>
                                    <a href=""data-toggle="modal" data-target="#checkReports"><span style="font-size:17px;"class="badge badge-pill badge-info">Check Reports</a>
                                  </div>
                              </div>
                            </div>
                          </div>
                        </div>




                      <div class="tab-pane" id="bottom-tab2">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card-box">
                                  <div class="table-responsive">

									                    <table class="table table-striped table-bordered" style="width:100%">
                                        <thead>

                                          <tr>
                                              <th>Tests</th>
                                              <th>Date</th>
                                              <th>Status</th>
                                              <th>Observation</th>

                                          </tr>

                                          {% for Lab in tests %}
                                        </thead>
                                        <tbody></div>
                                        <tr>

                                            <td>{{Lab.tests}}</td>
                                            <td>{{Lab.created_date}}</td>
                                            {% if Lab.teststatus.status == 'Done' %}
                                            <td><span class="badge badge-pill badge-success">Test done</span></td>
                                            {% endif %}
                                            {% if Lab.teststatus.status == 'Not Done' %}
                                            <td><span class="badge badge-pill badge-danger">Test not done</span></td>
                                            {% endif %}

                                            <td>N/A</td>

                                            {% endfor %}
                                        </tr>

                                      </tbody>

                                    </table>
                                    <a href=""data-toggle="modal" data-target="#results"><span style="font-size:17px;"class="badge badge-pill badge-info">Check Results</a>
                                  </div>
                              </div>
                            </div>
                          </div>
          						</div>


                      <div class="modal fade" id="results" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel">Results</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>

                              <div class="modal-body">
                            			     <ul class="list-group companyPosItemsList">
                                          {% for Lab in tests %}
                            				         <li class="list-group-item" >

                                					              <a href="{% url 'doctor:theResult' Lab.patient Lab.id %}"> <span class="companyPosLabel">{{Lab.tests}}</span></a></br>

                            				          </li>
                                              {% endfor %}
                            			     </ul>

                            		</div>



                            <div class="modal-footer">
                              <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
                            </div>
                            </div>
                          </div>
                        </div>


          						<!-- <div class="tab-pane" id="bottom-tab3">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card-box">
          							Tab content 3
                                </div>
                            </div>
          						</div>
          					</div> -->
                                            </div>
                        </div>
                      </div>
          				</div>
                </div>





          <!-- <div class="profile-tabs">
            <ul class="nav nav-tabs nav-tabs-bottom" >
              <li class="nav-item"><a class="nav-link active" href="#about-cont" data-toggle="tab">Report</a></li>
            </ul>
            <form method="POST">
              {% csrf_token %}
              <input type="text" name="patient" value="{{ onGoing.patient }}" readonly="True" hidden>
              <input type="text" name="appointmentId" value="{{ onGoing.id }}" readonly="True" hidden>
              <div class="row" >
                  <div class="col-md-12">
                      <div class="card-box">

                          {% for reports in reports %}

                            {{ add_report }}

                            {% endfor %}

                          </br>
                          <div class="button">
                            <button type="submit" class="btn btn-success mr-2">Save</button>
                          </div>
                        </div>
                        </div>
                      </div>
                  </div>
              </form> -->




{% if not scanCode %}
</br></br>
            <div class="alert alert-warning">
              <strong>Warning!!</strong>
              No information,please scan again <a href="{% url 'doctor:ScanCode' %}">here</a>
            </div>
{% endif %}

<div class="modal fade" id="checkReports" tabindex="-1" role="dialog" aria-labelledby="companyPositionLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">

            <h4 class="modal-title" id="companyPositionLabel">Medical History</h4>
          </div>
          <div class="modal-body">
        			     <ul class="list-group companyPosItemsList">
                      {% for Appointment in history %}
        				         <li class="list-group-item" >

            					               <a href="{% url 'doctor:theReport' Appointment.patient Appointment.id %}"><span class="companyPosLabel">{{Appointment}}</span></a></br>

        				          </li>
                          {% endfor %}
        			     </ul>

        		</div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
          </div>
        </div>
      </div>
    </div>


    <!-- <div class="modal fade" id="checkResults" tabindex="-1" role="dialog" aria-labelledby="companyPositionLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">

                <h4 class="modal-title" id="companyPositionLabel">Medical History</h4>
              </div>
              <div class="modal-body">
            			     <ul class="list-group companyPosItemsList">
                          {% for Tests in tests %}
            				         <li class="list-group-item" >

                					               <span class="companyPosLabel">{{tests.findings}}</span></a></br>

            				          </li>
                              {% endfor %}
            			     </ul>

            		</div>
              <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
              </div>
            </div>
          </div>
        </div> -->


{% endblock %}
